<html>
<head>
<meta charset="UTF-8"/>
<title>Auto Log Viewer</title>
<script type="text/javascript">
var fso = new ActiveXObject("Scripting.FileSystemObject");
var files = [];
function formatDate(d) {
    return (d.getFullYear() + '/' + (d.getMonth() + 1) + '/' + d.getDate() + ' ' + d.getHours() + ':'
    + d.getMinutes() + ':' + d.getSeconds()).replace(/(\D)(\d)(\b|(?=\D))/g, "$10$2");
}
function updateFileList() {
    var TemporaryFolder = 2
    var tfolder = fso.GetSpecialFolder(TemporaryFolder);
    files = [];
    for (var enumFiles = new Enumerator(tfolder.Files)
        ; ! enumFiles.atEnd(); enumFiles.moveNext()) {
        var f = enumFiles.item();
        var fd = {
            name: f.Name,
            path: f.Path,
            size: f.Size,
            dateLastModified: f.DateLastModified
        };
        files.push(fd);
    }
    files.sort(function (a, b) { return b.dateLastModified - a.dateLastModified; });

    var filelistDiv = document.getElementById('filelist');
    for (var i = filelistDiv.childNodes.length - 1; i >= 0; i--) {
        filelistDiv.removeChild(filelistDiv.childNodes.item(i));
    }
    var updateTimeLabelSpan = document.getElementById('updateTimeLabel');
    updateTimeLabelSpan.innerHTML = new Date().toString();
    for (var i in files) {
        var f = files[i];
        filelistDiv.appendChild(document.createTextNode(formatDate(new Date(f.dateLastModified)) + " "));
        var a = document.createElement('a');
        a.setAttribute('href', '');
        a.attachEvent('onclick', new Function('showLogFile(' + i + '); return false;'));
        a.appendChild(document.createTextNode(f.name));
        filelistDiv.appendChild(a);
        filelistDiv.appendChild(document.createTextNode(' (' + f.size + ')'));
        filelistDiv.appendChild(document.createElement('br'));
    }
}
function showLogFile(index) {
    var f = files[index];
    var cmd = 'cmd /c title "' + f.name + '" & cscript //nologo tailf.js "' + f.path + '"';
    var wsh = new ActiveXObject("WScript.Shell");
    wsh.Run(cmd);
}
window.attachEvent('onload', updateFileList);
</script>
</head>
<body>
<form id="form1">
<input type="radio" name="place" value="temp" checked>TEMP<br>
<!--
<input type="radio" name="place" value="desktop">DESKTOP<br>
<input type="radio" name="place" value="other">: <input type="text" name="p"><br>
-->
<hr>
<input type="button" id="updateButton" value="Update File List" onclick="updateFileList()">
<span id="updateTimeLabel">Update Time Label</span>
</form>
<div id="filelist">
<a id="f1" href="#" onclick="showLogFile()">file 1</a><br>
<a id="f2" href="#" onclick="showLogFile()">file 2</a><br>
</div>
</body>
</html>
